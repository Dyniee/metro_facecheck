<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Metro FaceCheck{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='unnamed.jpg') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chatbot.css') }}">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <nav class="navbar">
        <div class="navbar-container">
            <div class="navbar-brand">
                <a href="/" class="logo">
                    <span class="logo-icon">ğŸš‡</span>
                    <span class="logo-text">Metro FaceCheck</span>
                </a>
            </div>
            <div class="navbar-menu">
                {% if session.get('user') %}
                    <div class="user-menu">
                        <span class="user-greeting">Xin chÃ o, {{ session['user']['username'] }}</span>
                        {% if session['user']['role'] == 'admin' %}
                            <a href="/admin" class="nav-link admin-link">Admin</a>
                        {% else %}
                            <a href="{{ url_for('notifications_page') }}" class="nav-link notification-link">ğŸ”” ThÃ´ng bÃ¡o</a>
                            <a href="{{ url_for('wallet_page') }}" class="nav-link wallet-link">
                                ğŸ’° VÃ­ ({{ "{:,.0f} VNÄ".format(session['user']['balance'] or 0) }})
                            </a>
                            <a href="/buy_ticket" class="nav-link">Mua VÃ©</a>
                            <a href="/history" class="nav-link">Lá»‹ch Sá»­</a>
                        {% endif %}
                        <a href="/logout" class="nav-link logout-link">ÄÄƒng Xuáº¥t</a>
                    </div>
                {% else %}
                    <div class="auth-menu">
                        <a href="/login" class="nav-link">ÄÄƒng Nháº­p</a>
                        <a href="/register" class="nav-link register-link">ÄÄƒng KÃ½</a>
                    </div>
                {% endif %}
            </div>
        </div>
    </nav>


    <main class="main-content">
        {% if request.args.get('error') %}
            <div class="alert alert-error" id="error-alert">
                {{ request.args.get('error') }}
            </div>
        {% endif %}
       
        {% if error %}
            <div class="alert alert-error" id="error-alert">
                {{ error }}
            </div>
        {% endif %}


        {% block content %}{% endblock %}
    </main>
    
    {% if session.get('user') %} <div class="chat-widget-button" id="chat-widget-btn">
        <span>ğŸ¤–</span>
    </div>
    
    <div class="chat-window" id="chat-window">
        <div class="chat-header">
            <h4>ğŸ¤– Trá»£ lÃ½ áº¢o Metro</h4>
            <span class="chat-close-btn" id="chat-close-btn">&times;</span>
        </div>
        <div class="chat-body" id="chat-body">
            <div class="chat-message bot">
                ChÃ o báº¡n {{ session['user']['username'] }}! TÃ´i cÃ³ thá»ƒ giÃºp gÃ¬? <br>(VÃ­ dá»¥: "giÃ¡ vÃ© tá»« Báº¿n ThÃ nh Ä‘áº¿n Suá»‘i TiÃªn" hoáº·c "lá»‹ch tÃ u lÃºc 8h sÃ¡ng mai")
            </div>
        </div>
        <div class="chat-input-area">
            <input type="text" id="chat-input" placeholder="Nháº­p cÃ¢u há»i cá»§a báº¡n...">
            <button id="chat-send-btn">Gá»­i</button>
        </div>
    </div>
    {% endif %}
    <footer>
       
        <div class="footer-container">


            <div class="footer-column">
                <h4>ğŸš‡ Metro FaceCheck</h4>
                <p>Giáº£i phÃ¡p check-in báº±ng khuÃ´n máº·t cho tuyáº¿n metro hiá»‡n Ä‘áº¡i, an toÃ n vÃ  nhanh chÃ³ng.</p>
            </div>


            <div class="footer-column">
                <h4>Há»‡ thá»‘ng</h4>
                <ul>
                    <li><a href="/">Trang chá»§</a></li>
                    <li><a href="/buy_ticket">Mua vÃ©</a></li>
                    <li><a href="/history">Lá»‹ch sá»­</a></li>
                    <li><a href="/wallet">VÃ­ Ä‘iá»‡n tá»­</a></li>
                </ul>
            </div>


            <div class="footer-column">
                <h4>Há»— trá»£</h4>
                <ul>
                    <li><a href="#">CÃ¢u há»i thÆ°á»ng gáº·p</a></li>
                    <li><a href="#">HÆ°á»›ng dáº«n Ä‘Äƒng kÃ½</a></li>
                    <li><a href="#">ChÃ­nh sÃ¡ch báº£o máº­t</a></li>
                    <li><a href="#">Äiá»u khoáº£n sá»­ dá»¥ng</a></li>
                </ul>
            </div>


            <div class="footer-column">
                <h4>LiÃªn há»‡</h4>
                <p>ğŸ“ Hotline: 1900-999-888</p>
                <p>âœ‰ï¸ Email: support@metroface.com</p>


                <div class="social-icons">
                    <a href="#"><span>ğŸŒ</span></a>
                    <a href="#"><span>ğŸ“˜</span></a>
                    <a href="#"><span>ğŸ¦</span></a>
                    <a href="#"><span>ğŸ“¸</span></a>
                </div>
            </div>


        </div>


        <div class="footer-bottom">
            Â© 2025 Metro FaceCheck â€” Thiáº¿t káº¿ bá»Ÿi nhÃ³m sinh viÃªn UTH ğŸ§ âœ¨
        </div>
    </footer>
    <script>
        // Auto-hide error alerts after 5 seconds
        const errorAlert = document.getElementById('error-alert');
        if (errorAlert) {
            setTimeout(() => {
                errorAlert.style.display = 'none';
            }, 5000);
        }
    </script>
    {% block extra_js %}{% endblock %}
    
    {% if session.get('user') %}
    <script src="{{ url_for('static', filename='js/chatbot.js') }}"></script>
    {% endif %}
</body>
</html>